<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="ClaudeCodeMAUI.SettingsPage"
             Title="Impostazioni"
             BackgroundColor="{DynamicResource PageBackgroundColor}">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Header -->
            <VerticalStackLayout Spacing="5">
                <Label Text="âš™ï¸ Impostazioni"
                       FontSize="28"
                       FontAttributes="Bold"
                       TextColor="{DynamicResource PrimaryTextColor}" />
                <Label Text="Configura la tua esperienza con Claude Code GUI"
                       FontSize="14"
                       TextColor="{DynamicResource SecondaryTextColor}" />
            </VerticalStackLayout>

            <!-- Sezione: Ripristino Sessioni -->
            <Frame BorderColor="{DynamicResource BorderColor}"
                   CornerRadius="10"
                   Padding="15"
                   BackgroundColor="{DynamicResource CardBackgroundColor}"
                   HasShadow="True">
                <VerticalStackLayout Spacing="15">

                    <!-- Titolo sezione -->
                    <Label Text="ðŸ”„ Ripristino Sessioni"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{DynamicResource PrimaryTextColor}" />

                    <!-- Opzione 1: Show Resume Dialog -->
                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">
                        <VerticalStackLayout Grid.Column="0" VerticalOptions="Center">
                            <Label Text="Mostra dialog di ripristino sessione"
                                   FontSize="16"
                                   TextColor="{DynamicResource PrimaryTextColor}" />
                            <Label Text="Se disattivato, riprende automaticamente l'ultima sessione all'avvio"
                                   FontSize="12"
                                   TextColor="{DynamicResource SecondaryTextColor}"
                                   Margin="0,2,0,0" />
                        </VerticalStackLayout>
                        <Switch x:Name="SwitchShowResumeDialog"
                                Grid.Column="1"
                                VerticalOptions="Center"
                                Toggled="OnShowResumeDialogToggled" />
                    </Grid>

                    <!-- Opzione 2: Auto Send Summary Prompt -->
                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">
                        <VerticalStackLayout Grid.Column="0" VerticalOptions="Center">
                            <Label Text="Invia automaticamente prompt di riassunto"
                                   FontSize="16"
                                   TextColor="{DynamicResource PrimaryTextColor}" />
                            <Label Text="Chiede automaticamente a Claude un riassunto quando si riprende una sessione"
                                   FontSize="12"
                                   TextColor="{DynamicResource SecondaryTextColor}"
                                   Margin="0,2,0,0" />
                        </VerticalStackLayout>
                        <Switch x:Name="SwitchAutoSummary"
                                Grid.Column="1"
                                VerticalOptions="Center"
                                Toggled="OnAutoSummaryToggled" />
                    </Grid>

                    <!-- Opzione 3: Play Beep on Metadata -->
                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">
                        <VerticalStackLayout Grid.Column="0" VerticalOptions="Center">
                            <Label Text="Riproduci beep su metadata"
                                   FontSize="16"
                                   TextColor="{DynamicResource PrimaryTextColor}" />
                            <Label Text="Emette una notifica sonora quando arrivano le statistiche della risposta"
                                   FontSize="12"
                                   TextColor="{DynamicResource SecondaryTextColor}"
                                   Margin="0,2,0,0" />
                        </VerticalStackLayout>
                        <Switch x:Name="SwitchPlayBeep"
                                Grid.Column="1"
                                VerticalOptions="Center"
                                Toggled="OnPlayBeepToggled" />
                    </Grid>

                    <!-- Opzione 4: History Message Count -->
                    <Grid ColumnDefinitions="*,Auto,60" ColumnSpacing="10">
                        <VerticalStackLayout Grid.Column="0" VerticalOptions="Center">
                            <Label Text="Numero messaggi storici"
                                   FontSize="16"
                                   TextColor="{DynamicResource PrimaryTextColor}" />
                            <Label Text="Quanti messaggi precedenti visualizzare al ripristino sessione (0-50)"
                                   FontSize="12"
                                   TextColor="{DynamicResource SecondaryTextColor}"
                                   Margin="0,2,0,0" />
                        </VerticalStackLayout>
                        <Slider x:Name="SliderHistoryCount"
                                Grid.Column="1"
                                Minimum="0"
                                Maximum="50"
                                Value="10"
                                WidthRequest="150"
                                VerticalOptions="Center"
                                ValueChanged="OnHistoryCountChanged" />
                        <Label x:Name="LblHistoryCount"
                               Grid.Column="2"
                               Text="10"
                               FontSize="16"
                               FontAttributes="Bold"
                               TextColor="{DynamicResource PrimaryTextColor}"
                               VerticalOptions="Center"
                               HorizontalOptions="Center" />
                    </Grid>

                </VerticalStackLayout>
            </Frame>

            <!-- Sezione: Aspetto -->
            <Frame BorderColor="{DynamicResource BorderColor}"
                   CornerRadius="10"
                   Padding="15"
                   BackgroundColor="{DynamicResource CardBackgroundColor}"
                   HasShadow="True">
                <VerticalStackLayout Spacing="15">

                    <!-- Titolo sezione -->
                    <Label Text="ðŸŽ¨ Aspetto"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{DynamicResource PrimaryTextColor}" />

                    <!-- Opzione: Dark Theme -->
                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">
                        <VerticalStackLayout Grid.Column="0" VerticalOptions="Center">
                            <Label Text="Tema scuro"
                                   FontSize="16"
                                   TextColor="{DynamicResource PrimaryTextColor}" />
                            <Label Text="Usa il tema scuro per la visualizzazione della conversazione"
                                   FontSize="12"
                                   TextColor="{DynamicResource SecondaryTextColor}"
                                   Margin="0,2,0,0" />
                        </VerticalStackLayout>
                        <Switch x:Name="SwitchDarkTheme"
                                Grid.Column="1"
                                VerticalOptions="Center"
                                Toggled="OnDarkThemeToggled" />
                    </Grid>

                </VerticalStackLayout>
            </Frame>

            <!-- Sezione: Informazioni -->
            <Frame BorderColor="{DynamicResource BorderColor}"
                   CornerRadius="10"
                   Padding="15"
                   BackgroundColor="{DynamicResource CardBackgroundColor}"
                   HasShadow="True">
                <VerticalStackLayout Spacing="10">

                    <!-- Titolo sezione -->
                    <Label Text="â„¹ï¸ Informazioni"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{DynamicResource PrimaryTextColor}" />

                    <Label Text="Claude Code GUI"
                           FontSize="16"
                           FontAttributes="Bold"
                           TextColor="{DynamicResource PrimaryTextColor}" />

                    <Label x:Name="LblVersion"
                           Text="Versione: 1.0.0"
                           FontSize="14"
                           TextColor="{DynamicResource SecondaryTextColor}" />

                    <Label Text="Una GUI moderna per Claude Code con ripristino sessioni, rendering markdown e altro."
                           FontSize="12"
                           TextColor="{DynamicResource SecondaryTextColor}"
                           LineBreakMode="WordWrap" />

                </VerticalStackLayout>
            </Frame>

            <!-- Pulsanti azione -->
            <HorizontalStackLayout Spacing="10" HorizontalOptions="Center">
                <Button Text="Ripristina impostazioni predefinite"
                        Clicked="OnResetToDefaults"
                        BackgroundColor="#FF6B6B"
                        TextColor="White"
                        CornerRadius="5"
                        Padding="15,10" />
                <Button Text="Chiudi"
                        Clicked="OnClose"
                        BackgroundColor="#4ECDC4"
                        TextColor="White"
                        CornerRadius="5"
                        Padding="15,10" />
            </HorizontalStackLayout>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
